<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		 
			
  
    <meta name="twitter:card" content="summary"/>
    
      <meta name="twitter:image" content="https://Cody2333.github.io/blog/images/avatar.png" />
    
  
  
  <meta name="twitter:title" content="眼底图像识别报告"/>
  <meta name="twitter:description" content="简介 本次实验的目的是对眼底图像进行分类识别，数据的标签分为【0，1，2，3，4】五类，分别代表糖尿病视网膜病变的5个阶段，0为健康，4为最严"/>
  
    <meta name="twitter:site" content="@your_twitter_id"/>
  
  
  
  
    <meta name="twitter:creator" content="@coooody"/>
  



		
		<meta name="author" content="coooody">
		<meta name="description" content="科科">
		<meta name="generator" content="Hugo 0.36" />
		<title>眼底图像识别报告 &middot; Coooody&#39;s</title>
		<link rel="shortcut icon" href="https://Cody2333.github.io/blog/images/favicon.ico">
		<link rel="stylesheet" href="https://Cody2333.github.io/blog/css/style.css">
		<link rel="stylesheet" href="https://Cody2333.github.io/blog/css/highlight.css">

		
		<link rel="stylesheet" href="https://Cody2333.github.io/blog/css/font-awesome.min.css">
		

		

		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://Cody2333.github.io/blog/'> <span class="arrow">←</span>Home</a>
	
	<a href='https://Cody2333.github.io/blog/posts'>Archive</a>
	<a href='https://Cody2333.github.io/blog/tags'>Tags</a>
	<a href='https://Cody2333.github.io/blog/about'>About</a>

	

	
</nav>


        <section id="wrapper" class="post">
            <article>
                <header>
                    <h1>
                        眼底图像识别报告
                    </h1>
                    <h2 class="headline">
                    Mar 23, 2017 00:00
                    · 1100 words
                    · 3 minute read
                      <span class="tags">
                      
                      
                          
                              <a href="https://Cody2333.github.io/blog/tags/machine_learning">machine_learning</a>
                          
                              <a href="https://Cody2333.github.io/blog/tags/diabetic_retinopathy_detection">diabetic_retinopathy_detection</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                  
                    <div id="toc">
                      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#简介">简介</a></li>
<li><a href="#原始数据集">原始数据集</a></li>
<li><a href="#图像预处理">图像预处理</a></li>
<li><a href="#网络结构">网络结构</a></li>
<li><a href="#特征提取">特征提取</a></li>
<li><a href="#左右眼混合">左右眼混合</a></li>
<li><a href="#评分标准">评分标准</a></li>
<li><a href="#实验结果">实验结果</a></li>
</ul></li>
</ul>
</nav>
                    </div>
                  
                
                <section id="post-body">
                    

<h2 id="简介">简介</h2>

<p>本次实验的目的是对眼底图像进行分类识别，数据的标签分为【0，1，2，3，4】五类，分别代表糖尿病视网膜病变的5个阶段，0为健康，4为最严重。</p>

<p>我们的任务就是利用深度学习根据训练集训练模型，对测试集的数据进行预测分类，达到尽可能高的准确率。</p>

<h2 id="原始数据集">原始数据集</h2>

<ul>
<li>train set
包括 35126 张眼底图像的数据，分辨率不一，质量不一。
划分出其中的10%作为validation set。</li>
<li>test set
包括 53576 张眼底图像的数据，但是kaggle并未给出label，kaggle根据对这个测试集结果的评判来给出比赛的得分。</li>
</ul>

<h2 id="图像预处理">图像预处理</h2>

<ul>
<li>resize
以图像中的圆形眼底图片为边界进行裁剪，取中心部分。
调整分辨率分别为128x128,256x256,512x512，用于之后的训练。</li>
<li>Data augmentation
通过360度旋转，镜像等扩增数据集。</li>
</ul>

<h2 id="网络结构">网络结构</h2>

<p><img src="http://upload-images.jianshu.io/upload_images/2563527-25d873cea05d5baa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png" /></p>

<ul>
<li>为了减少训练时间，只选用了一个网络net B进行训练</li>
<li>使用10%的train set作为validation set</li>
<li>用128x128像素图片训练1-11 和  20-25层。</li>
<li>用256x256像素图片训练1-15 和  20-25层。初始时，使用上一次训练得到的权重作为1-11层的权重。</li>

<li><p>用512x512像素图片训练全部层。初始时，使用上一次训练得到的权重作为1-15层的权重。</p></li>

<li><p>最后得到三组权重（weights）
<code>[best kappa weight, best validation score weight, final weight]</code></p></li>
</ul>

<h2 id="特征提取">特征提取</h2>

<p>从 RMSPooling Layer提取特征。为了提升质量，重复进行20次特征提取，但是使用的是随机的data argumentation。然后在20次循环之后提取出 RMSPooling Layer的平均值和标准差，作为下一层blend network的输入。</p>

<h2 id="左右眼混合">左右眼混合</h2>

<p>对于每个病人，使用下面的特征作为网络的输入
<code>[this_eye_mean, other_eye_mean, this_eye_std, other_eye_std, right_eye_indicator]</code>
训练一个简单的全连接神经网络。</p>

<p>网络结构：</p>

<p>`<code>
Input        8193
Dense          32
Maxout         16
Dense          32
Maxout         16
</code></p>

<p>根据上文训练的三组weights，会生成三个blend network。然后对这三个network的输出取平均值，并且设置阈值为[0.5，1.5，2.5，3.5]来生成最终的分类结果。</p>

<h2 id="评分标准">评分标准</h2>

<p>kaggle对此比赛的评分基于 quadratic weighted kappa 算法。得分范围为0-1，分数越高证明模型的效果越好。</p>

<p>简单地说就是对于多分类问题，预测的越不准得分越低，比如把class=0预测成class=4的惩罚会比把class=0预测成class=1的惩罚重很多，进行随机预测的得分约为0。</p>

<p>具体的算法实现内容参见<a href="https://www.kaggle.com/c/diabetic-retinopathy-detection/details/evaluation">此链接</a></p>

<h2 id="实验结果">实验结果</h2>

<p>提交到kaggle进行评分，结果为8.42，略低于原队伍的8.44，但是考虑到我们所大幅度简化的网络，实际得到的结果还是不错的。</p>

<p>validation set的confusion matrix如下：
<img src="http://upload-images.jianshu.io/upload_images/2563527-e190e0077b75e00d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="confusion matrix" />
可以看到，对于糖尿病视网膜病变的识别率能达到约92%左右，误报率为8%左右。</p>

<p>整个训练耗时约30+小时，使用一块GTX1080显卡。</p>

                </section>
            </article>

            

            

            
                <ul id="post-list" class="archive readmore">
    <h3>Read more</h3>

    
    
    
        <li>
            <a href="/blog/posts/%E6%9B%B4%E5%A5%BD%E7%9A%84%E4%BD%BF%E7%94%A8swagger%E7%BB%B4%E6%8A%A4node%E7%9A%84%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/">koa-swagger-decorator:基于注解根据API自动生成可视化swagger文档<aside class="dates">Feb 10 2018</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93%E5%92%8C%E6%9C%89%E7%94%A8%E7%9A%84%E6%96%87%E7%AB%A0/">一些总结和有用的文章<aside class="dates">Feb 1 2018</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/%E7%90%86%E8%A7%A3node-js%E4%B8%AD%E7%9A%84stream/">理解nodeJs中的stream<aside class="dates">Jan 22 2018</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/%E5%AF%B9%E6%8A%97%E6%A0%B7%E6%9C%AC%E5%92%8C%E5%AF%B9%E6%8A%97%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0------%E7%AE%80%E8%BF%B0/">对抗样本和对抗训练笔记<aside class="dates">Jan 18 2018</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/%E8%A7%A3%E5%86%B3%E5%8D%B8%E8%BD%BD360%E8%85%BE%E8%AE%AF%E7%AE%A1%E5%AE%B6%E7%AD%89%E5%AE%89%E5%85%A8%E8%BD%AF%E4%BB%B6%E5%AF%BC%E8%87%B4windows-defender%E6%9C%8D%E5%8A%A1%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98/">解决卸载360，腾讯管家等安全软件导致windows-defender服务无法启动问题<aside class="dates">Sep 18 2017</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/%E4%BD%BF%E7%94%A8vscode%E8%B0%83%E8%AF%95babel%E7%BC%96%E8%AF%91%E7%9A%84node-js%E9%A1%B9%E7%9B%AE/">使用VSCode调试babel编译的nodeJs项目<aside class="dates">Aug 16 2017</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%90%8E%E3%81%AE%E5%BC%82%E4%B8%96%E7%95%8C-%E5%8A%A8%E7%94%BB%E8%84%9A%E6%9C%AC/">浏览器后の异世界-动画脚本<aside class="dates">May 21 2017</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/%E7%90%86%E8%A7%A3%E7%BB%9F%E8%AE%A1%E7%9B%B8%E5%85%B3%E6%80%A7%E7%9A%84kappa%E7%B3%BB%E6%95%B0/">理解统计相关性的kappa系数<aside class="dates">Apr 28 2017</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/git%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">Git工作流的最佳实践<aside class="dates">Apr 18 2017</aside></a>
        </li>
    
        <li>
            <a href="/blog/posts/%E5%9F%BA%E4%BA%8Epromise%E5%92%8Casync-await%E7%9A%84%E5%BC%82%E6%AD%A5%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/">基于Promise和Async-Await的异步流程控制<aside class="dates">Apr 18 2017</aside></a>
        </li>
    
</ul>

            

            <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://www.facebook.com/cody.wang.585">
        <i class="fa fa-facebook-square"></i>
    </a>
    
    <a class="symbol" href="https://www.github.com/Cody2333">
        <i class="fa fa-github-square"></i>
    </a>
    


</div>

    
    <p class="small">
    
       © Copyright 2018 <i class="fa fa-heart" aria-hidden="true"></i> coooody
    
    </p>
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

        </section>

        <script src="https://Cody2333.github.io/blog/js/jquery-3.3.1.min.js"></script>
<script src="https://Cody2333.github.io/blog/js/main.js"></script>
<script src="https://Cody2333.github.io/blog/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>







    </body>
</html>
